[
  {
    "cmd": [
      "vpython",
      "-u",
      "RECIPE_MODULE[recipe_engine::file]/resources/fileutil.py",
      "--json-output",
      "/path/to/tmp/json",
      "copy",
      "[BUILDER_CACHE]/v8/infra/testing/builders.pyl",
      "/path/to/tmp/"
    ],
    "infra_step": true,
    "name": "initialization.read test spec (v8)",
    "~followup_annotations": [
      "@@@STEP_NEST_LEVEL@1@@@",
      "@@@STEP_LOG_LINE@builders.pyl@{\"V8 Foobar\": {@@@",
      "@@@STEP_LOG_LINE@builders.pyl@      \"swarming_dimensions\": {@@@",
      "@@@STEP_LOG_LINE@builders.pyl@        \"pool\": \"noodle\",@@@",
      "@@@STEP_LOG_LINE@builders.pyl@        \"gpu\": \"quantum\",@@@",
      "@@@STEP_LOG_LINE@builders.pyl@      },@@@",
      "@@@STEP_LOG_LINE@builders.pyl@      \"swarming_task_attrs\": {@@@",
      "@@@STEP_LOG_LINE@builders.pyl@        \"priority\": 25,@@@",
      "@@@STEP_LOG_LINE@builders.pyl@        \"hard_timeout\": 7200,@@@",
      "@@@STEP_LOG_LINE@builders.pyl@        \"expiration\": 7200,@@@",
      "@@@STEP_LOG_LINE@builders.pyl@      },@@@",
      "@@@STEP_LOG_LINE@builders.pyl@      \"tests\": [@@@",
      "@@@STEP_LOG_LINE@builders.pyl@        {@@@",
      "@@@STEP_LOG_LINE@builders.pyl@          \"name\": \"mjsunit\",@@@",
      "@@@STEP_LOG_LINE@builders.pyl@          \"variant\": \"sweet\",@@@",
      "@@@STEP_LOG_LINE@builders.pyl@          \"shards\": 2,@@@",
      "@@@STEP_LOG_LINE@builders.pyl@        },@@@",
      "@@@STEP_LOG_LINE@builders.pyl@        {@@@",
      "@@@STEP_LOG_LINE@builders.pyl@          \"name\": \"mjsunit\",@@@",
      "@@@STEP_LOG_LINE@builders.pyl@          \"variant\": \"sour\",@@@",
      "@@@STEP_LOG_LINE@builders.pyl@          \"suffix\": \"everything\",@@@",
      "@@@STEP_LOG_LINE@builders.pyl@          \"test_args\": [\"--extra-flags\", \"--flag1 --flag2\"],@@@",
      "@@@STEP_LOG_LINE@builders.pyl@          # This tests that the default pool dimension above is overridden.@@@",
      "@@@STEP_LOG_LINE@builders.pyl@          \"swarming_dimensions\": {\"pool\": \"override\"},@@@",
      "@@@STEP_LOG_LINE@builders.pyl@          # This tests that the default priority above is overridden.@@@",
      "@@@STEP_LOG_LINE@builders.pyl@          \"swarming_task_attrs\": {\"priority\": 100},@@@",
      "@@@STEP_LOG_LINE@builders.pyl@        },@@@",
      "@@@STEP_LOG_LINE@builders.pyl@      ],@@@",
      "@@@STEP_LOG_LINE@builders.pyl@    }}@@@",
      "@@@STEP_LOG_END@builders.pyl@@@",
      "@@@STEP_LOG_LINE@test_spec@V8 Foobar@@@",
      "@@@STEP_LOG_LINE@test_spec@  mjsunit(2) sweet@@@",
      "@@@STEP_LOG_LINE@test_spec@  mjsunit(1) sour@@@",
      "@@@STEP_LOG_END@test_spec@@@"
    ]
  },
  {
    "cmd": [
      "python",
      "-u",
      "[BUILDER_CACHE]/v8/tools/mb/mb.py",
      "gen",
      "-m",
      "client.v8",
      "-b",
      "V8 Foobar builder",
      "--config-file",
      "[BUILDER_CACHE]/v8/infra/mb/mb_config.pyl",
      "--goma-dir",
      "[GOMA_CACHE]/client",
      "--json-output",
      "/path/to/tmp/json",
      "--isolate-map-file",
      "[BUILDER_CACHE]/v8/infra/mb/gn_isolate_map.pyl",
      "--swarming-targets-file",
      "mjsunit\n",
      "//out/Release"
    ],
    "cwd": "[BUILDER_CACHE]/v8",
    "env": {
      "CHROME_HEADLESS": "1",
      "GOMA_USE_LOCAL": "false"
    },
    "name": "build.generate_build_files",
    "~followup_annotations": [
      "@@@STEP_NEST_LEVEL@1@@@",
      "@@@STEP_LOG_LINE@json.output[failure_summary]@{}@@@",
      "@@@STEP_LOG_END@json.output[failure_summary]@@@",
      "@@@STEP_LOG_LINE@swarming-targets-file.txt@mjsunit@@@",
      "@@@STEP_LOG_END@swarming-targets-file.txt@@@",
      "@@@STEP_LOG_LINE@gn_args@target_cpu = \"x86\" use_goma = true@@@",
      "@@@STEP_LOG_END@gn_args@@@"
    ]
  },
  {
    "cmd": [
      "[BUILDER_CACHE]/v8/tools/luci-go/isolate",
      "batcharchive",
      "--dump-json",
      "/path/to/tmp/json",
      "--isolate-server",
      "https://isolateserver.appspot.com",
      "--namespace",
      "default-gzip",
      "--eventlog-endpoint",
      "prod",
      "--verbose",
      "--blacklist",
      "*.pyc",
      "--blacklist",
      "*.swp",
      "--blacklist",
      ".git",
      "[BUILDER_CACHE]/v8/out/Release/mjsunit.isolated.gen.json"
    ],
    "name": "build.isolate tests",
    "~followup_annotations": [
      "@@@STEP_NEST_LEVEL@1@@@",
      "@@@STEP_LOG_LINE@json.output@{@@@",
      "@@@STEP_LOG_LINE@json.output@  \"mjsunit\": \"[dummy hash for mjsunit]\"@@@",
      "@@@STEP_LOG_LINE@json.output@}@@@",
      "@@@STEP_LOG_END@json.output@@@",
      "@@@SET_BUILD_PROPERTY@isolate_server@\"https://isolateserver.appspot.com\"@@@"
    ]
  },
  {
    "cmd": [
      "prpc",
      "call",
      "-format=json",
      "luci-scheduler.appspot.com",
      "scheduler.Scheduler.EmitTriggers"
    ],
    "infra_step": true,
    "name": "trigger",
    "stdin": "{\"batches\": [{\"jobs\": [{\"job\": \"V8 Foobar\", \"project\": \"v8\"}], \"trigger\": {\"buildbucket\": {\"properties\": {\"newest_gitiles_revision\": \"bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb\", \"oldest_gitiles_revision\": \"aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa\", \"parent_build_config\": \"Release\", \"parent_build_environment\": {\"gn_args\": \"target_cpu = \\\"x86\\\" use_goma = true\"}, \"parent_buildername\": \"V8 Foobar builder\", \"parent_got_revision\": \"f2cbea7e89a45f46819777bb78a1f5bd0241f64c\", \"parent_got_revision_cp\": \"refs/heads/master@{#50110}\", \"parent_got_swarming_client_revision\": \"e4fee0b18f8163be6097c9c571640038896debc4\", \"parent_test_spec\": {\"swarming_dimensions\": {\"gpu\": \"quantum\", \"pool\": \"noodle\"}, \"swarming_task_attrs\": {\"expiration\": 7200, \"hard_timeout\": 7200, \"priority\": 25}, \"tests\": [[\"mjsunit\", 2, \"sweet\", \"sweet\", [], {}, {}], [\"mjsunit\", 1, \"sour\", \"everything\", [\"--extra-flags\", \"--flag1 --flag2\"], {\"pool\": \"override\"}, {\"priority\": 100}]]}, \"revision\": \"f2cbea7e89a45f46819777bb78a1f5bd0241f64c\", \"swarm_hashes\": {\"mjsunit\": \"[dummy hash for mjsunit]\"}}, \"tags\": [\"buildset:commit/gitiles/chromium.googlesource.com/v8/v8/+/deadbeefdeadbeefdeadbeefdeadbeefdeadbeef\", \"gitiles_ref:refs/heads/master\", \"parent_buildername:V8 Foobar builder\", \"parent_buildnumber:571\", \"user_agent:recipe\"]}, \"id\": \"6a0a73b0-070b-492b-9135-9f26a2a00001\", \"title\": \"V8 Foobar builder/571\"}}], \"timestamp\": 1337000001500000}",
    "~followup_annotations": [
      "@@@STEP_LOG_LINE@input@{@@@",
      "@@@STEP_LOG_LINE@input@    \"batches\": [@@@",
      "@@@STEP_LOG_LINE@input@        {@@@",
      "@@@STEP_LOG_LINE@input@            \"jobs\": [@@@",
      "@@@STEP_LOG_LINE@input@                {@@@",
      "@@@STEP_LOG_LINE@input@                    \"job\": \"V8 Foobar\", @@@",
      "@@@STEP_LOG_LINE@input@                    \"project\": \"v8\"@@@",
      "@@@STEP_LOG_LINE@input@                }@@@",
      "@@@STEP_LOG_LINE@input@            ], @@@",
      "@@@STEP_LOG_LINE@input@            \"trigger\": {@@@",
      "@@@STEP_LOG_LINE@input@                \"buildbucket\": {@@@",
      "@@@STEP_LOG_LINE@input@                    \"properties\": {@@@",
      "@@@STEP_LOG_LINE@input@                        \"newest_gitiles_revision\": \"bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb\", @@@",
      "@@@STEP_LOG_LINE@input@                        \"oldest_gitiles_revision\": \"aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa\", @@@",
      "@@@STEP_LOG_LINE@input@                        \"parent_build_config\": \"Release\", @@@",
      "@@@STEP_LOG_LINE@input@                        \"parent_build_environment\": {@@@",
      "@@@STEP_LOG_LINE@input@                            \"gn_args\": \"target_cpu = \\\"x86\\\" use_goma = true\"@@@",
      "@@@STEP_LOG_LINE@input@                        }, @@@",
      "@@@STEP_LOG_LINE@input@                        \"parent_buildername\": \"V8 Foobar builder\", @@@",
      "@@@STEP_LOG_LINE@input@                        \"parent_got_revision\": \"f2cbea7e89a45f46819777bb78a1f5bd0241f64c\", @@@",
      "@@@STEP_LOG_LINE@input@                        \"parent_got_revision_cp\": \"refs/heads/master@{#50110}\", @@@",
      "@@@STEP_LOG_LINE@input@                        \"parent_got_swarming_client_revision\": \"e4fee0b18f8163be6097c9c571640038896debc4\", @@@",
      "@@@STEP_LOG_LINE@input@                        \"parent_test_spec\": {@@@",
      "@@@STEP_LOG_LINE@input@                            \"swarming_dimensions\": {@@@",
      "@@@STEP_LOG_LINE@input@                                \"gpu\": \"quantum\", @@@",
      "@@@STEP_LOG_LINE@input@                                \"pool\": \"noodle\"@@@",
      "@@@STEP_LOG_LINE@input@                            }, @@@",
      "@@@STEP_LOG_LINE@input@                            \"swarming_task_attrs\": {@@@",
      "@@@STEP_LOG_LINE@input@                                \"expiration\": 7200, @@@",
      "@@@STEP_LOG_LINE@input@                                \"hard_timeout\": 7200, @@@",
      "@@@STEP_LOG_LINE@input@                                \"priority\": 25@@@",
      "@@@STEP_LOG_LINE@input@                            }, @@@",
      "@@@STEP_LOG_LINE@input@                            \"tests\": [@@@",
      "@@@STEP_LOG_LINE@input@                                [@@@",
      "@@@STEP_LOG_LINE@input@                                    \"mjsunit\", @@@",
      "@@@STEP_LOG_LINE@input@                                    2, @@@",
      "@@@STEP_LOG_LINE@input@                                    \"sweet\", @@@",
      "@@@STEP_LOG_LINE@input@                                    \"sweet\", @@@",
      "@@@STEP_LOG_LINE@input@                                    [], @@@",
      "@@@STEP_LOG_LINE@input@                                    {}, @@@",
      "@@@STEP_LOG_LINE@input@                                    {}@@@",
      "@@@STEP_LOG_LINE@input@                                ], @@@",
      "@@@STEP_LOG_LINE@input@                                [@@@",
      "@@@STEP_LOG_LINE@input@                                    \"mjsunit\", @@@",
      "@@@STEP_LOG_LINE@input@                                    1, @@@",
      "@@@STEP_LOG_LINE@input@                                    \"sour\", @@@",
      "@@@STEP_LOG_LINE@input@                                    \"everything\", @@@",
      "@@@STEP_LOG_LINE@input@                                    [@@@",
      "@@@STEP_LOG_LINE@input@                                        \"--extra-flags\", @@@",
      "@@@STEP_LOG_LINE@input@                                        \"--flag1 --flag2\"@@@",
      "@@@STEP_LOG_LINE@input@                                    ], @@@",
      "@@@STEP_LOG_LINE@input@                                    {@@@",
      "@@@STEP_LOG_LINE@input@                                        \"pool\": \"override\"@@@",
      "@@@STEP_LOG_LINE@input@                                    }, @@@",
      "@@@STEP_LOG_LINE@input@                                    {@@@",
      "@@@STEP_LOG_LINE@input@                                        \"priority\": 100@@@",
      "@@@STEP_LOG_LINE@input@                                    }@@@",
      "@@@STEP_LOG_LINE@input@                                ]@@@",
      "@@@STEP_LOG_LINE@input@                            ]@@@",
      "@@@STEP_LOG_LINE@input@                        }, @@@",
      "@@@STEP_LOG_LINE@input@                        \"revision\": \"f2cbea7e89a45f46819777bb78a1f5bd0241f64c\", @@@",
      "@@@STEP_LOG_LINE@input@                        \"swarm_hashes\": {@@@",
      "@@@STEP_LOG_LINE@input@                            \"mjsunit\": \"[dummy hash for mjsunit]\"@@@",
      "@@@STEP_LOG_LINE@input@                        }@@@",
      "@@@STEP_LOG_LINE@input@                    }, @@@",
      "@@@STEP_LOG_LINE@input@                    \"tags\": [@@@",
      "@@@STEP_LOG_LINE@input@                        \"buildset:commit/gitiles/chromium.googlesource.com/v8/v8/+/deadbeefdeadbeefdeadbeefdeadbeefdeadbeef\", @@@",
      "@@@STEP_LOG_LINE@input@                        \"gitiles_ref:refs/heads/master\", @@@",
      "@@@STEP_LOG_LINE@input@                        \"parent_buildername:V8 Foobar builder\", @@@",
      "@@@STEP_LOG_LINE@input@                        \"parent_buildnumber:571\", @@@",
      "@@@STEP_LOG_LINE@input@                        \"user_agent:recipe\"@@@",
      "@@@STEP_LOG_LINE@input@                    ]@@@",
      "@@@STEP_LOG_LINE@input@                }, @@@",
      "@@@STEP_LOG_LINE@input@                \"id\": \"6a0a73b0-070b-492b-9135-9f26a2a00001\", @@@",
      "@@@STEP_LOG_LINE@input@                \"title\": \"V8 Foobar builder/571\"@@@",
      "@@@STEP_LOG_LINE@input@            }@@@",
      "@@@STEP_LOG_LINE@input@        }@@@",
      "@@@STEP_LOG_LINE@input@    ], @@@",
      "@@@STEP_LOG_LINE@input@    \"timestamp\": 1337000001500000@@@",
      "@@@STEP_LOG_LINE@input@}@@@",
      "@@@STEP_LOG_END@input@@@"
    ]
  }
]