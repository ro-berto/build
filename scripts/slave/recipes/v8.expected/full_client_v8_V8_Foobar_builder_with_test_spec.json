[
  {
    "cmd": [
      "python",
      "-u",
      "RECIPE_MODULE[recipe_engine::file]/resources/fileutil.py",
      "--json-output",
      "/path/to/tmp/json",
      "copy",
      "[BUILDER_CACHE]/v8/infra/testing/builders.pyl",
      "/path/to/tmp/"
    ],
    "infra_step": true,
    "name": "initialization.read test spec (v8)",
    "~followup_annotations": [
      "@@@STEP_NEST_LEVEL@1@@@",
      "@@@STEP_LOG_LINE@test_spec@V8 Foobar@@@",
      "@@@STEP_LOG_LINE@test_spec@  mjsunit(2) sweet@@@",
      "@@@STEP_LOG_LINE@test_spec@  mjsunit(1) sour@@@",
      "@@@STEP_LOG_END@test_spec@@@"
    ]
  },
  {
    "cmd": [
      "python",
      "-u",
      "[BUILDER_CACHE]/v8/tools/mb/mb.py",
      "gen",
      "-m",
      "client.v8",
      "-b",
      "V8 Foobar builder",
      "--config-file",
      "[BUILDER_CACHE]/v8/infra/mb/mb_config.pyl",
      "--goma-dir",
      "[GOMA_CACHE]/client",
      "--swarming-targets-file",
      "mjsunit\n",
      "//out/Release"
    ],
    "cwd": "[BUILDER_CACHE]/v8",
    "env": {
      "CHROME_HEADLESS": "1",
      "GOMA_USE_LOCAL": "false"
    },
    "name": "build.generate_build_files",
    "~followup_annotations": [
      "@@@STEP_NEST_LEVEL@1@@@",
      "@@@STEP_LOG_LINE@swarming-targets-file.txt@mjsunit@@@",
      "@@@STEP_LOG_END@swarming-targets-file.txt@@@",
      "@@@STEP_LOG_LINE@gn_args@target_cpu = \"x86\" use_goma = true@@@",
      "@@@STEP_LOG_END@gn_args@@@"
    ]
  },
  {
    "cmd": [
      "python",
      "-u",
      "RECIPE_MODULE[build::isolate]/resources/isolate.py",
      "[BUILDER_CACHE]/v8/tools/swarming_client",
      "batcharchive",
      "--dump-json",
      "/path/to/tmp/json",
      "--isolate-server",
      "https://isolateserver.appspot.com",
      "--eventlog-endpoint",
      "prod",
      "--verbose",
      "--blacklist",
      "*.pyc",
      "--blacklist",
      "*.swp",
      "--blacklist",
      ".git",
      "[BUILDER_CACHE]/v8/out/Release/mjsunit.isolated.gen.json"
    ],
    "name": "build.isolate tests",
    "~followup_annotations": [
      "@@@STEP_NEST_LEVEL@1@@@",
      "@@@STEP_LOG_LINE@json.output@{@@@",
      "@@@STEP_LOG_LINE@json.output@  \"mjsunit\": \"[dummy hash for mjsunit]\"@@@",
      "@@@STEP_LOG_LINE@json.output@}@@@",
      "@@@STEP_LOG_END@json.output@@@",
      "@@@SET_BUILD_PROPERTY@isolate_server@\"https://isolateserver.appspot.com\"@@@"
    ]
  },
  {
    "cmd": [
      "prpc",
      "call",
      "-format=json",
      "luci-scheduler.appspot.com",
      "scheduler.Scheduler.EmitTriggers"
    ],
    "infra_step": true,
    "name": "trigger",
    "stdin": "{\"batches\": [{\"jobs\": [{\"job\": \"V8 Foobar\", \"project\": \"v8\"}], \"trigger\": {\"buildbucket\": {\"properties\": {\"parent_build_config\": \"Release\", \"parent_build_environment\": {\"gn_args\": \"target_cpu = \\\"x86\\\" use_goma = true\"}, \"parent_buildername\": \"V8 Foobar builder\", \"parent_got_revision\": \"f2cbea7e89a45f46819777bb78a1f5bd0241f64c\", \"parent_got_revision_cp\": \"refs/heads/master@{#50110}\", \"parent_got_swarming_client_revision\": \"e4fee0b18f8163be6097c9c571640038896debc4\", \"parent_test_spec\": {\"swarming_dimensions\": {\"gpu\": \"quantum\", \"pool\": \"noodle\"}, \"swarming_task_attrs\": {\"hard_timeout\": 7200, \"priority\": 25}, \"tests\": [[\"mjsunit\", 2, \"sweet\", \"sweet\", [], {}, {}], [\"mjsunit\", 1, \"sour\", \"everything\", [\"--extra-flags\", \"--flag1 --flag2\"], {\"pool\": \"override\"}, {\"priority\": 100}]]}, \"revision\": \"f2cbea7e89a45f46819777bb78a1f5bd0241f64c\", \"swarm_hashes\": {\"mjsunit\": \"[dummy hash for mjsunit]\"}}, \"tags\": [\"parent_buildername:V8 Foobar builder\", \"parent_buildnumber:571\", \"user_agent:recipe\"]}, \"id\": \"6a0a73b0-070b-492b-9135-9f26a2a00001\", \"title\": \"V8 Foobar builder/571\"}}], \"timestamp\": 1337000003000000}",
    "stdout": "/path/to/tmp/json",
    "~followup_annotations": [
      "@@@STEP_TEXT@input {",
      "    \"batches\": [",
      "        {",
      "            \"jobs\": [",
      "                {",
      "                    \"job\": \"V8 Foobar\", ",
      "                    \"project\": \"v8\"",
      "                }",
      "            ], ",
      "            \"trigger\": {",
      "                \"buildbucket\": {",
      "                    \"properties\": {",
      "                        \"parent_build_config\": \"Release\", ",
      "                        \"parent_build_environment\": {",
      "                            \"gn_args\": \"target_cpu = \\\"x86\\\" use_goma = true\"",
      "                        }, ",
      "                        \"parent_buildername\": \"V8 Foobar builder\", ",
      "                        \"parent_got_revision\": \"f2cbea7e89a45f46819777bb78a1f5bd0241f64c\", ",
      "                        \"parent_got_revision_cp\": \"refs/heads/master@{#50110}\", ",
      "                        \"parent_got_swarming_client_revision\": \"e4fee0b18f8163be6097c9c571640038896debc4\", ",
      "                        \"parent_test_spec\": {",
      "                            \"swarming_dimensions\": {",
      "                                \"gpu\": \"quantum\", ",
      "                                \"pool\": \"noodle\"",
      "                            }, ",
      "                            \"swarming_task_attrs\": {",
      "                                \"hard_timeout\": 7200, ",
      "                                \"priority\": 25",
      "                            }, ",
      "                            \"tests\": [",
      "                                [",
      "                                    \"mjsunit\", ",
      "                                    2, ",
      "                                    \"sweet\", ",
      "                                    \"sweet\", ",
      "                                    [], ",
      "                                    {}, ",
      "                                    {}",
      "                                ], ",
      "                                [",
      "                                    \"mjsunit\", ",
      "                                    1, ",
      "                                    \"sour\", ",
      "                                    \"everything\", ",
      "                                    [",
      "                                        \"--extra-flags\", ",
      "                                        \"--flag1 --flag2\"",
      "                                    ], ",
      "                                    {",
      "                                        \"pool\": \"override\"",
      "                                    }, ",
      "                                    {",
      "                                        \"priority\": 100",
      "                                    }",
      "                                ]",
      "                            ]",
      "                        }, ",
      "                        \"revision\": \"f2cbea7e89a45f46819777bb78a1f5bd0241f64c\", ",
      "                        \"swarm_hashes\": {",
      "                            \"mjsunit\": \"[dummy hash for mjsunit]\"",
      "                        }",
      "                    }, ",
      "                    \"tags\": [",
      "                        \"parent_buildername:V8 Foobar builder\", ",
      "                        \"parent_buildnumber:571\", ",
      "                        \"user_agent:recipe\"",
      "                    ]",
      "                }, ",
      "                \"id\": \"6a0a73b0-070b-492b-9135-9f26a2a00001\", ",
      "                \"title\": \"V8 Foobar builder/571\"",
      "            }",
      "        }",
      "    ], ",
      "    \"timestamp\": 1337000003000000",
      "}@@@"
    ]
  }
]