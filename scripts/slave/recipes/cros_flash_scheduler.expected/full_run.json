[
  {
    "cmd": [
      "python",
      "-u",
      "RECIPE_MODULE[depot_tools::git]/resources/git_setup.py",
      "--path",
      "[START_DIR]/swarming.client",
      "--url",
      "https://chromium.googlesource.com/infra/luci/client-py.git"
    ],
    "name": "git setup (swarming_client)"
  },
  {
    "cmd": [
      "git",
      "retry",
      "fetch",
      "origin",
      "master",
      "--progress"
    ],
    "cwd": "[START_DIR]/swarming.client",
    "env": {
      "PATH": "RECIPE_PACKAGE_REPO[depot_tools]:<PATH>"
    },
    "infra_step": true,
    "name": "git fetch (swarming_client)"
  },
  {
    "cmd": [
      "git",
      "checkout",
      "-f",
      "FETCH_HEAD"
    ],
    "cwd": "[START_DIR]/swarming.client",
    "infra_step": true,
    "name": "git checkout (swarming_client)"
  },
  {
    "cmd": [
      "git",
      "rev-parse",
      "HEAD"
    ],
    "cwd": "[START_DIR]/swarming.client",
    "infra_step": true,
    "name": "read revision",
    "stdout": "/path/to/tmp/",
    "~followup_annotations": [
      "@@@STEP_TEXT@<br/>checked out 'deadbeef'<br/>@@@"
    ]
  },
  {
    "cmd": [
      "git",
      "clean",
      "-f",
      "-d",
      "-x"
    ],
    "cwd": "[START_DIR]/swarming.client",
    "infra_step": true,
    "name": "git clean (swarming_client)"
  },
  {
    "cmd": [
      "git",
      "submodule",
      "sync"
    ],
    "cwd": "[START_DIR]/swarming.client",
    "infra_step": true,
    "name": "submodule sync (swarming_client)"
  },
  {
    "cmd": [
      "git",
      "submodule",
      "update",
      "--init",
      "--recursive"
    ],
    "cwd": "[START_DIR]/swarming.client",
    "infra_step": true,
    "name": "submodule update (swarming_client)"
  },
  {
    "cmd": [
      "python",
      "-u",
      "RECIPE_MODULE[depot_tools::gitiles]/resources/gerrit_client.py",
      "--json-file",
      "/path/to/tmp/json",
      "--url",
      "https://chromium.googlesource.com/chromium/src/+/master/chromeos/CHROMEOS_LKGM",
      "--format",
      "text"
    ],
    "name": "fetch CHROMEOS_LKGM",
    "~followup_annotations": [
      "@@@STEP_TEXT@current LKGM: 12345.0.0 @@@"
    ]
  },
  {
    "cmd": [
      "python",
      "-u",
      "[START_DIR]/swarming.client/swarming.py",
      "query",
      "-S",
      "some-swarming-server",
      "bots/list?dimensions=device_type:some-device-type&dimensions=pool:some-swarming-pool"
    ],
    "name": "get all bots",
    "stdout": "/path/to/tmp/json",
    "~followup_annotations": [
      "@@@STEP_LOG_LINE@json.output@{@@@",
      "@@@STEP_LOG_LINE@json.output@  \"items\": [@@@",
      "@@@STEP_LOG_LINE@json.output@    {@@@",
      "@@@STEP_LOG_LINE@json.output@      \"bot_id\": \"up_to_date_bot\", @@@",
      "@@@STEP_LOG_LINE@json.output@      \"dimensions\": [@@@",
      "@@@STEP_LOG_LINE@json.output@        {@@@",
      "@@@STEP_LOG_LINE@json.output@          \"key\": \"device_os\", @@@",
      "@@@STEP_LOG_LINE@json.output@          \"value\": [@@@",
      "@@@STEP_LOG_LINE@json.output@            \"12345\"@@@",
      "@@@STEP_LOG_LINE@json.output@          ]@@@",
      "@@@STEP_LOG_LINE@json.output@        }@@@",
      "@@@STEP_LOG_LINE@json.output@      ], @@@",
      "@@@STEP_LOG_LINE@json.output@      \"is_dead\": false, @@@",
      "@@@STEP_LOG_LINE@json.output@      \"quarantined\": false@@@",
      "@@@STEP_LOG_LINE@json.output@    }, @@@",
      "@@@STEP_LOG_LINE@json.output@    {@@@",
      "@@@STEP_LOG_LINE@json.output@      \"bot_id\": \"out_of_date_bot\", @@@",
      "@@@STEP_LOG_LINE@json.output@      \"dimensions\": [@@@",
      "@@@STEP_LOG_LINE@json.output@        {@@@",
      "@@@STEP_LOG_LINE@json.output@          \"key\": \"device_os\", @@@",
      "@@@STEP_LOG_LINE@json.output@          \"value\": [@@@",
      "@@@STEP_LOG_LINE@json.output@            \"11111\"@@@",
      "@@@STEP_LOG_LINE@json.output@          ]@@@",
      "@@@STEP_LOG_LINE@json.output@        }@@@",
      "@@@STEP_LOG_LINE@json.output@      ], @@@",
      "@@@STEP_LOG_LINE@json.output@      \"is_dead\": false, @@@",
      "@@@STEP_LOG_LINE@json.output@      \"quarantined\": false@@@",
      "@@@STEP_LOG_LINE@json.output@    }, @@@",
      "@@@STEP_LOG_LINE@json.output@    {@@@",
      "@@@STEP_LOG_LINE@json.output@      \"bot_id\": \"unhealthy_bot\", @@@",
      "@@@STEP_LOG_LINE@json.output@      \"dimensions\": [@@@",
      "@@@STEP_LOG_LINE@json.output@        {@@@",
      "@@@STEP_LOG_LINE@json.output@          \"key\": \"device_os\", @@@",
      "@@@STEP_LOG_LINE@json.output@          \"value\": [@@@",
      "@@@STEP_LOG_LINE@json.output@            \"12345\"@@@",
      "@@@STEP_LOG_LINE@json.output@          ]@@@",
      "@@@STEP_LOG_LINE@json.output@        }@@@",
      "@@@STEP_LOG_LINE@json.output@      ], @@@",
      "@@@STEP_LOG_LINE@json.output@      \"is_dead\": false, @@@",
      "@@@STEP_LOG_LINE@json.output@      \"quarantined\": true@@@",
      "@@@STEP_LOG_LINE@json.output@    }@@@",
      "@@@STEP_LOG_LINE@json.output@  ]@@@",
      "@@@STEP_LOG_LINE@json.output@}@@@",
      "@@@STEP_LOG_END@json.output@@@",
      "@@@STEP_LOG_LINE@found 3 bots@up_to_date_bot@@@",
      "@@@STEP_LOG_LINE@found 3 bots@out_of_date_bot@@@",
      "@@@STEP_LOG_LINE@found 3 bots@unhealthy_bot@@@",
      "@@@STEP_LOG_END@found 3 bots@@@",
      "@@@STEP_LOG_LINE@unhealthy bots@unhealthy_bot@@@",
      "@@@STEP_LOG_END@unhealthy bots@@@",
      "@@@STEP_LOG_LINE@up to date bots@up_to_date_bot@@@",
      "@@@STEP_LOG_END@up to date bots@@@",
      "@@@STEP_LOG_LINE@out of date bots@out_of_date_bot@@@",
      "@@@STEP_LOG_END@out of date bots@@@"
    ]
  },
  {
    "jsonResult": null,
    "name": "$result"
  }
]