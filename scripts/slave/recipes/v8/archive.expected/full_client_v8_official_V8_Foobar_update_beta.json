[
  {
    "cmd": [],
    "name": "make archive (ref)"
  },
  {
    "cmd": [
      "python",
      "-u",
      "[BUILDER_CACHE]/v8/tools/release/filter_build_files.py",
      "--dir",
      "[BUILDER_CACHE]/v8/out/Release",
      "--platform",
      "linux",
      "--type",
      "ref",
      "--json-output",
      "/path/to/tmp/json"
    ],
    "infra_step": true,
    "name": "make archive (ref).filter build files",
    "~followup_annotations": [
      "@@@STEP_NEST_LEVEL@1@@@",
      "@@@STEP_LOG_LINE@json.output@[@@@",
      "@@@STEP_LOG_LINE@json.output@  \"[BUILDER_CACHE]/v8/out/Release/d8\", @@@",
      "@@@STEP_LOG_LINE@json.output@  \"[BUILDER_CACHE]/v8/out/Release/icudtl.dat\"@@@",
      "@@@STEP_LOG_LINE@json.output@]@@@",
      "@@@STEP_LOG_END@json.output@@@"
    ]
  },
  {
    "cmd": [
      "python",
      "-u",
      "RECIPE_MODULE[build::zip]/resources/zip.py"
    ],
    "name": "make archive (ref).zipping",
    "stdin": "{\"entries\": [{\"archive_name\": null, \"path\": \"[BUILDER_CACHE]/v8/out/Release/d8\", \"type\": \"file\"}, {\"archive_name\": null, \"path\": \"[BUILDER_CACHE]/v8/out/Release/icudtl.dat\", \"type\": \"file\"}], \"output\": \"[CLEANUP]/archive.zip\", \"root\": \"[BUILDER_CACHE]/v8/out/Release\"}",
    "~followup_annotations": [
      "@@@STEP_NEST_LEVEL@1@@@"
    ]
  },
  {
    "cmd": [
      "python",
      "-u",
      "RECIPE_MODULE[depot_tools::gsutil]/resources/gsutil_smart_retry.py",
      "--",
      "RECIPE_REPO[depot_tools]/gsutil.py",
      "----",
      "cp",
      "-a",
      "public-read",
      "[CLEANUP]/archive.zip",
      "gs://chromium-v8/official/refbuild/v8-linux64-rel.zip"
    ],
    "infra_step": true,
    "name": "make archive (ref).gsutil update refbuild binaries",
    "~followup_annotations": [
      "@@@STEP_NEST_LEVEL@1@@@",
      "@@@STEP_LINK@gsutil.upload@https://storage.cloud.google.com/chromium-v8/official/refbuild/v8-linux64-rel.zip@@@"
    ]
  },
  {
    "cmd": [
      "bb",
      "batch",
      "-host",
      "cr-buildbucket.appspot.com"
    ],
    "infra_step": true,
    "name": "make archive (ref).trigger refbuild bundler",
    "stdin": "{\"requests\": [{\"scheduleBuild\": {\"builder\": {\"bucket\": \"ci\", \"builder\": \"v8_refbuild_bundler\", \"project\": \"v8-internal\"}, \"gitilesCommit\": {\"host\": \"chromium.googlesource.com\", \"id\": \"aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa\", \"project\": \"v8/v8\", \"ref\": \"refs/branch-heads/3.4\"}, \"properties\": {\"platform\": \"linux64\", \"revision\": \"f2cbea7e89a45f46819777bb78a1f5bd0241f64c\"}, \"requestId\": \"8945511751514863184-00000000-0000-0000-0000-000000001337\", \"tags\": [{\"key\": \"user_agent\", \"value\": \"recipe\"}]}}]}",
    "stdout": "/path/to/tmp/json",
    "~followup_annotations": [
      "@@@STEP_NEST_LEVEL@1@@@",
      "@@@STEP_LOG_LINE@json.output@{@@@",
      "@@@STEP_LOG_LINE@json.output@  \"responses\": [@@@",
      "@@@STEP_LOG_LINE@json.output@    {@@@",
      "@@@STEP_LOG_LINE@json.output@      \"scheduleBuild\": {@@@",
      "@@@STEP_LOG_LINE@json.output@        \"builder\": {@@@",
      "@@@STEP_LOG_LINE@json.output@          \"bucket\": \"ci\", @@@",
      "@@@STEP_LOG_LINE@json.output@          \"builder\": \"v8_refbuild_bundler\", @@@",
      "@@@STEP_LOG_LINE@json.output@          \"project\": \"v8-internal\"@@@",
      "@@@STEP_LOG_LINE@json.output@        }, @@@",
      "@@@STEP_LOG_LINE@json.output@        \"id\": \"8922054662172514000\"@@@",
      "@@@STEP_LOG_LINE@json.output@      }@@@",
      "@@@STEP_LOG_LINE@json.output@    }@@@",
      "@@@STEP_LOG_LINE@json.output@  ]@@@",
      "@@@STEP_LOG_LINE@json.output@}@@@",
      "@@@STEP_LOG_END@json.output@@@",
      "@@@STEP_LOG_LINE@request@{@@@",
      "@@@STEP_LOG_LINE@request@  \"requests\": [@@@",
      "@@@STEP_LOG_LINE@request@    {@@@",
      "@@@STEP_LOG_LINE@request@      \"scheduleBuild\": {@@@",
      "@@@STEP_LOG_LINE@request@        \"gitilesCommit\": {@@@",
      "@@@STEP_LOG_LINE@request@          \"project\": \"v8/v8\", @@@",
      "@@@STEP_LOG_LINE@request@          \"host\": \"chromium.googlesource.com\", @@@",
      "@@@STEP_LOG_LINE@request@          \"ref\": \"refs/branch-heads/3.4\", @@@",
      "@@@STEP_LOG_LINE@request@          \"id\": \"aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa\"@@@",
      "@@@STEP_LOG_LINE@request@        }, @@@",
      "@@@STEP_LOG_LINE@request@        \"builder\": {@@@",
      "@@@STEP_LOG_LINE@request@          \"project\": \"v8-internal\", @@@",
      "@@@STEP_LOG_LINE@request@          \"builder\": \"v8_refbuild_bundler\", @@@",
      "@@@STEP_LOG_LINE@request@          \"bucket\": \"ci\"@@@",
      "@@@STEP_LOG_LINE@request@        }, @@@",
      "@@@STEP_LOG_LINE@request@        \"tags\": [@@@",
      "@@@STEP_LOG_LINE@request@          {@@@",
      "@@@STEP_LOG_LINE@request@            \"value\": \"recipe\", @@@",
      "@@@STEP_LOG_LINE@request@            \"key\": \"user_agent\"@@@",
      "@@@STEP_LOG_LINE@request@          }@@@",
      "@@@STEP_LOG_LINE@request@        ], @@@",
      "@@@STEP_LOG_LINE@request@        \"requestId\": \"8945511751514863184-00000000-0000-0000-0000-000000001337\", @@@",
      "@@@STEP_LOG_LINE@request@        \"properties\": {@@@",
      "@@@STEP_LOG_LINE@request@          \"platform\": \"linux64\", @@@",
      "@@@STEP_LOG_LINE@request@          \"revision\": \"f2cbea7e89a45f46819777bb78a1f5bd0241f64c\"@@@",
      "@@@STEP_LOG_LINE@request@        }@@@",
      "@@@STEP_LOG_LINE@request@      }@@@",
      "@@@STEP_LOG_LINE@request@    }@@@",
      "@@@STEP_LOG_LINE@request@  ]@@@",
      "@@@STEP_LOG_LINE@request@}@@@",
      "@@@STEP_LOG_END@request@@@",
      "@@@STEP_LINK@v8-internal/ci/v8_refbuild_bundler/8922054662172514000@https://cr-buildbucket.appspot.com/build/8922054662172514000@@@"
    ]
  }
]