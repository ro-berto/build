[
  {
    "cmd": [
      "python",
      "-u",
      "RECIPE_REPO[depot_tools]/gclient.py",
      "revinfo",
      "--filter=https://chrome-infra-packages.appspot.com/dart/third_party/co19",
      "--filter=https://chrome-infra-packages.appspot.com/dart/third_party/co19/legacy",
      "--output-json",
      "/path/to/tmp/json"
    ],
    "cwd": "[CACHE]/builder/sdk",
    "env_suffixes": {
      "PATH": [
        "RECIPE_REPO[depot_tools]"
      ]
    },
    "infra_step": true,
    "name": "gclient get co19 versions",
    "~followup_annotations": [
      "@@@STEP_LOG_LINE@json.output[revinfo]@{@@@",
      "@@@STEP_LOG_LINE@json.output[revinfo]@  \"sdk/tests/co19_2/src:dart/third_party/co19\": {@@@",
      "@@@STEP_LOG_LINE@json.output[revinfo]@    \"rev\": \"git_revision:co19_2_hash\", @@@",
      "@@@STEP_LOG_LINE@json.output[revinfo]@    \"url\": \"https://chrome-infra-packages.appspot.com/dart/third_party/co19\"@@@",
      "@@@STEP_LOG_LINE@json.output[revinfo]@  }@@@",
      "@@@STEP_LOG_LINE@json.output[revinfo]@}@@@",
      "@@@STEP_LOG_END@json.output[revinfo]@@@"
    ]
  },
  {
    "cmd": [],
    "name": "trigger shards for co19"
  },
  {
    "cmd": [],
    "name": "trigger shards for co19.ensure swarming",
    "~followup_annotations": [
      "@@@STEP_NEST_LEVEL@1@@@"
    ]
  },
  {
    "cmd": [
      "cipd",
      "ensure",
      "-root",
      "[CACHE]/swarming_client",
      "-ensure-file",
      "infra/tools/luci/swarming/${platform} git_revision:386eb9fd6a1e21d174824c786a0eee9d883dad56",
      "-json-output",
      "/path/to/tmp/json"
    ],
    "cwd": "[CACHE]/builder/sdk",
    "env": {
      "BUILDBOT_BUILDERNAME": "co19-be"
    },
    "env_suffixes": {
      "PATH": [
        "RECIPE_REPO[depot_tools]"
      ]
    },
    "infra_step": true,
    "name": "trigger shards for co19.ensure swarming.ensure_installed",
    "~followup_annotations": [
      "@@@STEP_NEST_LEVEL@2@@@",
      "@@@STEP_LOG_LINE@json.output@{@@@",
      "@@@STEP_LOG_LINE@json.output@  \"result\": {@@@",
      "@@@STEP_LOG_LINE@json.output@    \"\": [@@@",
      "@@@STEP_LOG_LINE@json.output@      {@@@",
      "@@@STEP_LOG_LINE@json.output@        \"instance_id\": \"resolved-instance_id-of-git_revision:386\", @@@",
      "@@@STEP_LOG_LINE@json.output@        \"package\": \"infra/tools/luci/swarming/resolved-platform\"@@@",
      "@@@STEP_LOG_LINE@json.output@      }@@@",
      "@@@STEP_LOG_LINE@json.output@    ]@@@",
      "@@@STEP_LOG_LINE@json.output@  }@@@",
      "@@@STEP_LOG_LINE@json.output@}@@@",
      "@@@STEP_LOG_END@json.output@@@"
    ]
  },
  {
    "cmd": [
      "[CACHE]/swarming_client/swarming",
      "spawn-tasks",
      "-server",
      "https://example.swarmingserver.appspot.com",
      "-json-input",
      "{\"requests\": [{\"name\": \"co19_shard_1\", \"priority\": \"25\", \"service_account\": \"\", \"task_slices\": [{\"expiration_secs\": \"3600\", \"properties\": {\"caches\": [{\"name\": \"vpython\", \"path\": \"cache/vpython\"}], \"cipd_input\": {\"packages\": [{\"package_name\": \"infra/tools/luci/vpython/${platform}\", \"path\": \"cipd_bin_packages\", \"version\": \"git_revision:e317c7d2c17d4c3460ee37524dfce4e1dee4306a\"}, {\"package_name\": \"infra/tools/luci/vpython-native/${platform}\", \"path\": \"cipd_bin_packages\", \"version\": \"git_revision:e317c7d2c17d4c3460ee37524dfce4e1dee4306a\"}, {\"package_name\": \"infra/3pp/tools/cpython/${platform}\", \"path\": \"cipd_bin_packages/cpython\", \"version\": \"version:2.7.17.chromium.24\"}, {\"package_name\": \"infra/3pp/tools/cpython3/${platform}\", \"path\": \"cipd_bin_packages/cpython3\", \"version\": \"version:3.8.1rc1.chromium.10\"}, {\"package_name\": \"dart/third_party/co19\", \"path\": \"tests/co19/src\", \"version\": null}, {\"package_name\": \"dart/third_party/co19\", \"path\": \"tests/co19_2/src\", \"version\": \"git_revision:co19_2_hash\"}, {\"package_name\": \"dart/dart-sdk/${platform}\", \"path\": \"tools/sdks\", \"version\": \"\"}]}, \"command\": [\"tools/test.py\", \"--progress=status\", \"--report\", \"--time\", \"--silent-failures\", \"--write-results\", \"--write-logs\", \"--clean-exit\", \"co19/nnbd\", \"co19_2\", \"--copy-coredumps\", \"--shards=1\", \"--shard=1\", \"--output-directory=${ISOLATED_OUTDIR}\"], \"containment\": {\"containment_type\": \"AUTO\", \"limit_processes\": \"0\", \"limit_total_committed_memory\": \"0\", \"lower_priority\": false}, \"dimensions\": [{\"key\": \"os\", \"value\": \"Linux\"}, {\"key\": \"cpu\", \"value\": \"x86-64\"}, {\"key\": \"pool\", \"value\": \"dart.tests\"}], \"env\": [{\"key\": \"VPYTHON_VIRTUALENV_ROOT\", \"value\": \"cache/vpython\"}], \"env_prefixes\": [{\"key\": \"PATH\", \"value\": [\"cipd_bin_packages\", \"cipd_bin_packages/bin\", \"cipd_bin_packages/cpython\", \"cipd_bin_packages/cpython/bin\", \"cipd_bin_packages/cpython3\", \"cipd_bin_packages/cpython3/bin\"]}], \"execution_timeout_secs\": \"3600\", \"grace_period_secs\": \"30\", \"idempotent\": false, \"inputs_ref\": {\"isolated\": \"test_hash\", \"isolatedserver\": \"https://example.isolateserver.appspot.com\", \"namespace\": \"default-gzip\"}, \"io_timeout_secs\": \"1200\", \"outputs\": []}}]}]}",
      "-json-output",
      "/path/to/tmp/json"
    ],
    "cwd": "[CACHE]/builder/sdk",
    "env": {
      "BUILDBOT_BUILDERNAME": "co19-be"
    },
    "env_suffixes": {
      "PATH": [
        "RECIPE_REPO[depot_tools]"
      ]
    },
    "infra_step": true,
    "name": "trigger shards for co19.trigger shards for co19",
    "~followup_annotations": [
      "@@@STEP_NEST_LEVEL@1@@@",
      "@@@STEP_LOG_LINE@json.output@{@@@",
      "@@@STEP_LOG_LINE@json.output@  \"tasks\": [@@@",
      "@@@STEP_LOG_LINE@json.output@    {@@@",
      "@@@STEP_LOG_LINE@json.output@      \"request\": {@@@",
      "@@@STEP_LOG_LINE@json.output@        \"name\": \"co19_shard_1\"@@@",
      "@@@STEP_LOG_LINE@json.output@      }, @@@",
      "@@@STEP_LOG_LINE@json.output@      \"task_id\": \"0\"@@@",
      "@@@STEP_LOG_LINE@json.output@    }@@@",
      "@@@STEP_LOG_LINE@json.output@  ]@@@",
      "@@@STEP_LOG_LINE@json.output@}@@@",
      "@@@STEP_LOG_END@json.output@@@",
      "@@@STEP_LINK@task UI: co19_shard_1@https://example.swarmingserver.appspot.com/task?id=0@@@"
    ]
  },
  {
    "cmd": [
      "[CACHE]/swarming_client/swarming",
      "collect",
      "-server",
      "https://example.swarmingserver.appspot.com",
      "-task-summary-json",
      "/path/to/tmp/json",
      "-task-output-stdout",
      "json",
      "-output-dir",
      "[CLEANUP]/tmp_tmp_1",
      "0"
    ],
    "infra_step": true,
    "name": "co19_shard_1",
    "~followup_annotations": [
      "@@@STEP_LOG_LINE@json.output@{@@@",
      "@@@STEP_LOG_LINE@json.output@  \"0\": {@@@",
      "@@@STEP_LOG_LINE@json.output@    \"output\": \"hello world!\", @@@",
      "@@@STEP_LOG_LINE@json.output@    \"outputs\": [], @@@",
      "@@@STEP_LOG_LINE@json.output@    \"results\": {@@@",
      "@@@STEP_LOG_LINE@json.output@      \"bot_id\": \"vm-123\", @@@",
      "@@@STEP_LOG_LINE@json.output@      \"duration\": 62.35, @@@",
      "@@@STEP_LOG_LINE@json.output@      \"exit_code\": 0, @@@",
      "@@@STEP_LOG_LINE@json.output@      \"name\": \"co19_shard_1\", @@@",
      "@@@STEP_LOG_LINE@json.output@      \"outputs_ref\": {@@@",
      "@@@STEP_LOG_LINE@json.output@        \"isolated\": \"abc123\", @@@",
      "@@@STEP_LOG_LINE@json.output@        \"isolatedserver\": \"https://isolateserver.appspot.com\", @@@",
      "@@@STEP_LOG_LINE@json.output@        \"namespace\": \"default-gzip\"@@@",
      "@@@STEP_LOG_LINE@json.output@      }, @@@",
      "@@@STEP_LOG_LINE@json.output@      \"state\": \"COMPLETED\", @@@",
      "@@@STEP_LOG_LINE@json.output@      \"task_id\": \"0\"@@@",
      "@@@STEP_LOG_LINE@json.output@    }@@@",
      "@@@STEP_LOG_LINE@json.output@  }@@@",
      "@@@STEP_LOG_LINE@json.output@}@@@",
      "@@@STEP_LOG_END@json.output@@@",
      "@@@STEP_LOG_LINE@task stdout+stderr: co19_shard_1@hello world!@@@",
      "@@@STEP_LOG_END@task stdout+stderr: co19_shard_1@@@",
      "@@@STEP_LINK@task isolated outputs: co19_shard_1@https://isolateserver.appspot.com/browse?namespace=default-gzip&hash=abc123@@@"
    ]
  },
  {
    "cmd": [
      "vpython",
      "-u",
      "RECIPE_MODULE[recipe_engine::file]/resources/fileutil.py",
      "--json-output",
      "/path/to/tmp/json",
      "copy",
      "[CLEANUP]/tmp_tmp_1/0/logs.json",
      "/path/to/tmp/"
    ],
    "infra_step": true,
    "name": "read logs.json for co19_shard_1",
    "~followup_annotations": [
      "@@@STEP_LOG_LINE@logs.json@{\"test\":\"log\"}@@@",
      "@@@STEP_LOG_END@logs.json@@@"
    ]
  },
  {
    "cmd": [
      "vpython",
      "-u",
      "RECIPE_MODULE[recipe_engine::file]/resources/fileutil.py",
      "--json-output",
      "/path/to/tmp/json",
      "copy",
      "[CLEANUP]/tmp_tmp_1/0/results.json",
      "/path/to/tmp/"
    ],
    "infra_step": true,
    "name": "read results.json for co19_shard_1",
    "~followup_annotations": [
      "@@@STEP_LOG_LINE@results.json@{\"name\":\"test1\"}@@@",
      "@@@STEP_LOG_LINE@results.json@{\"name\":\"test2\"}@@@",
      "@@@STEP_LOG_END@results.json@@@"
    ]
  },
  {
    "cmd": [
      "[CACHE]/builder/sdk/tools/sdks/dart-sdk/bin/dart",
      "tools/bots/compare_results.dart",
      "--flakiness-data",
      "LATEST/flaky.json",
      "--changed",
      "--passing",
      "--failing",
      "--count",
      "50",
      "LATEST/results.json",
      "{\"name\":\"test1\",\"bot_name\":\"vm-123\"}\n{\"name\":\"test2\",\"bot_name\":\"vm-123\"}\n"
    ],
    "cwd": "[CACHE]/builder/sdk",
    "infra_step": true,
    "name": "deflaking.list tests to deflake (co19)",
    "~followup_annotations": [
      "@@@STEP_NEST_LEVEL@1@@@",
      "@@@STEP_LOG_LINE@raw_io.output_text@Flaky/Test/1@@@",
      "@@@STEP_LOG_LINE@raw_io.output_text@Flaky/Test/2@@@",
      "@@@STEP_LOG_END@raw_io.output_text@@@"
    ]
  },
  {
    "cmd": [],
    "name": "deflaking.trigger shards for co19",
    "~followup_annotations": [
      "@@@STEP_NEST_LEVEL@1@@@"
    ]
  },
  {
    "cmd": [
      "[CACHE]/swarming_client/swarming",
      "spawn-tasks",
      "-server",
      "https://example.swarmingserver.appspot.com",
      "-json-input",
      "{\"requests\": [{\"name\": \"co19_shard_1\", \"priority\": \"25\", \"service_account\": \"\", \"tags\": [\"optional:true\"], \"task_slices\": [{\"expiration_secs\": \"3600\", \"properties\": {\"caches\": [{\"name\": \"vpython\", \"path\": \"cache/vpython\"}], \"cipd_input\": {\"packages\": [{\"package_name\": \"infra/tools/luci/vpython/${platform}\", \"path\": \"cipd_bin_packages\", \"version\": \"git_revision:e317c7d2c17d4c3460ee37524dfce4e1dee4306a\"}, {\"package_name\": \"infra/tools/luci/vpython-native/${platform}\", \"path\": \"cipd_bin_packages\", \"version\": \"git_revision:e317c7d2c17d4c3460ee37524dfce4e1dee4306a\"}, {\"package_name\": \"infra/3pp/tools/cpython/${platform}\", \"path\": \"cipd_bin_packages/cpython\", \"version\": \"version:2.7.17.chromium.24\"}, {\"package_name\": \"infra/3pp/tools/cpython3/${platform}\", \"path\": \"cipd_bin_packages/cpython3\", \"version\": \"version:3.8.1rc1.chromium.10\"}, {\"package_name\": \"dart/third_party/co19\", \"path\": \"tests/co19/src\", \"version\": null}, {\"package_name\": \"dart/third_party/co19\", \"path\": \"tests/co19_2/src\", \"version\": \"git_revision:co19_2_hash\"}, {\"package_name\": \"dart/dart-sdk/${platform}\", \"path\": \"tools/sdks\", \"version\": \"\"}]}, \"command\": [\"tools/test.py\", \"--progress=status\", \"--report\", \"--time\", \"--silent-failures\", \"--write-results\", \"--write-logs\", \"--clean-exit\", \"co19/nnbd\", \"co19_2\", \"--repeat=5\", \"--tests\", \"Flaky/Test/1\\nFlaky/Test/2\", \"--copy-coredumps\", \"--shards=1\", \"--shard=1\", \"--output-directory=${ISOLATED_OUTDIR}\"], \"containment\": {\"containment_type\": \"AUTO\", \"limit_processes\": \"0\", \"limit_total_committed_memory\": \"0\", \"lower_priority\": false}, \"dimensions\": [{\"key\": \"os\", \"value\": \"Linux\"}, {\"key\": \"cpu\", \"value\": \"x86-64\"}, {\"key\": \"pool\", \"value\": \"dart.tests\"}], \"env\": [{\"key\": \"VPYTHON_VIRTUALENV_ROOT\", \"value\": \"cache/vpython\"}], \"env_prefixes\": [{\"key\": \"PATH\", \"value\": [\"cipd_bin_packages\", \"cipd_bin_packages/bin\", \"cipd_bin_packages/cpython\", \"cipd_bin_packages/cpython/bin\", \"cipd_bin_packages/cpython3\", \"cipd_bin_packages/cpython3/bin\"]}], \"execution_timeout_secs\": \"3600\", \"grace_period_secs\": \"30\", \"idempotent\": false, \"inputs_ref\": {\"isolated\": \"test_hash\", \"isolatedserver\": \"https://example.isolateserver.appspot.com\", \"namespace\": \"default-gzip\"}, \"io_timeout_secs\": \"1200\", \"outputs\": []}}]}]}",
      "-json-output",
      "/path/to/tmp/json"
    ],
    "cwd": "[CACHE]/builder/sdk",
    "env": {
      "BUILDBOT_BUILDERNAME": "co19-be"
    },
    "env_suffixes": {
      "PATH": [
        "RECIPE_REPO[depot_tools]"
      ]
    },
    "infra_step": true,
    "name": "deflaking.trigger shards for co19.trigger shards for co19",
    "~followup_annotations": [
      "@@@STEP_NEST_LEVEL@2@@@",
      "@@@STEP_LOG_LINE@json.output@{@@@",
      "@@@STEP_LOG_LINE@json.output@  \"tasks\": [@@@",
      "@@@STEP_LOG_LINE@json.output@    {@@@",
      "@@@STEP_LOG_LINE@json.output@      \"request\": {@@@",
      "@@@STEP_LOG_LINE@json.output@        \"name\": \"co19_shard_1\"@@@",
      "@@@STEP_LOG_LINE@json.output@      }, @@@",
      "@@@STEP_LOG_LINE@json.output@      \"task_id\": \"0\"@@@",
      "@@@STEP_LOG_LINE@json.output@    }@@@",
      "@@@STEP_LOG_LINE@json.output@  ]@@@",
      "@@@STEP_LOG_LINE@json.output@}@@@",
      "@@@STEP_LOG_END@json.output@@@",
      "@@@STEP_LINK@task UI: co19_shard_1@https://example.swarmingserver.appspot.com/task?id=0@@@"
    ]
  },
  {
    "cmd": [
      "[CACHE]/swarming_client/swarming",
      "collect",
      "-server",
      "https://example.swarmingserver.appspot.com",
      "-task-summary-json",
      "/path/to/tmp/json",
      "-task-output-stdout",
      "json",
      "-output-dir",
      "[CLEANUP]/tmp_tmp_2",
      "0"
    ],
    "cwd": "[CACHE]/builder/sdk",
    "infra_step": true,
    "name": "deflaking.co19_shard_1",
    "~followup_annotations": [
      "@@@STEP_NEST_LEVEL@1@@@",
      "@@@STEP_LOG_LINE@json.output@{@@@",
      "@@@STEP_LOG_LINE@json.output@  \"0\": {@@@",
      "@@@STEP_LOG_LINE@json.output@    \"output\": \"hello world!\", @@@",
      "@@@STEP_LOG_LINE@json.output@    \"outputs\": [], @@@",
      "@@@STEP_LOG_LINE@json.output@    \"results\": {@@@",
      "@@@STEP_LOG_LINE@json.output@      \"bot_id\": \"vm-123\", @@@",
      "@@@STEP_LOG_LINE@json.output@      \"duration\": 62.35, @@@",
      "@@@STEP_LOG_LINE@json.output@      \"exit_code\": 0, @@@",
      "@@@STEP_LOG_LINE@json.output@      \"name\": \"co19_shard_1\", @@@",
      "@@@STEP_LOG_LINE@json.output@      \"outputs_ref\": {@@@",
      "@@@STEP_LOG_LINE@json.output@        \"isolated\": \"abc123\", @@@",
      "@@@STEP_LOG_LINE@json.output@        \"isolatedserver\": \"https://isolateserver.appspot.com\", @@@",
      "@@@STEP_LOG_LINE@json.output@        \"namespace\": \"default-gzip\"@@@",
      "@@@STEP_LOG_LINE@json.output@      }, @@@",
      "@@@STEP_LOG_LINE@json.output@      \"state\": \"COMPLETED\", @@@",
      "@@@STEP_LOG_LINE@json.output@      \"task_id\": \"0\"@@@",
      "@@@STEP_LOG_LINE@json.output@    }@@@",
      "@@@STEP_LOG_LINE@json.output@  }@@@",
      "@@@STEP_LOG_LINE@json.output@}@@@",
      "@@@STEP_LOG_END@json.output@@@",
      "@@@STEP_LOG_LINE@task stdout+stderr: co19_shard_1@hello world!@@@",
      "@@@STEP_LOG_END@task stdout+stderr: co19_shard_1@@@",
      "@@@STEP_LINK@task isolated outputs: co19_shard_1@https://isolateserver.appspot.com/browse?namespace=default-gzip&hash=abc123@@@"
    ]
  },
  {
    "cmd": [
      "vpython",
      "-u",
      "RECIPE_MODULE[recipe_engine::file]/resources/fileutil.py",
      "--json-output",
      "/path/to/tmp/json",
      "copy",
      "[CLEANUP]/tmp_tmp_2/0/logs.json",
      "/path/to/tmp/"
    ],
    "cwd": "[CACHE]/builder/sdk",
    "infra_step": true,
    "name": "deflaking.read logs.json for co19_shard_1",
    "~followup_annotations": [
      "@@@STEP_NEST_LEVEL@1@@@",
      "@@@STEP_LOG_LINE@logs.json@{\"Flaky/Test/1\":\"log\"}@@@",
      "@@@STEP_LOG_LINE@logs.json@{\"Flaky/Test/2\":\"log\"}@@@",
      "@@@STEP_LOG_END@logs.json@@@"
    ]
  },
  {
    "cmd": [
      "vpython",
      "-u",
      "RECIPE_MODULE[recipe_engine::file]/resources/fileutil.py",
      "--json-output",
      "/path/to/tmp/json",
      "copy",
      "[CLEANUP]/tmp_tmp_2/0/results.json",
      "/path/to/tmp/"
    ],
    "cwd": "[CACHE]/builder/sdk",
    "infra_step": true,
    "name": "deflaking.read results.json for co19_shard_1",
    "~followup_annotations": [
      "@@@STEP_NEST_LEVEL@1@@@",
      "@@@STEP_LOG_LINE@results.json@{\"name\":\"Flaky/Test/1\"}@@@",
      "@@@STEP_LOG_LINE@results.json@{\"name\":\"Flaky/Test/2\"}@@@",
      "@@@STEP_LOG_END@results.json@@@"
    ]
  },
  {
    "cmd": [
      "python",
      "-u",
      "RECIPE_MODULE[depot_tools::gsutil]/resources/gsutil_smart_retry.py",
      "--",
      "RECIPE_REPO[depot_tools]/gsutil.py",
      "----",
      "cp",
      "",
      "gs://dart-test-results/builders/current_flakiness/single_directory/flaky_current_co19.json"
    ],
    "cwd": "[CACHE]/builder/sdk",
    "infra_step": true,
    "name": "upload new results.gsutil upload flaky_current_co19.json",
    "~followup_annotations": [
      "@@@STEP_NEST_LEVEL@1@@@",
      "@@@STEP_LINK@gsutil.upload@https://storage.cloud.google.com/dart-test-results/builders/current_flakiness/single_directory/flaky_current_co19.json@@@"
    ]
  }
]