[
  {
    "cmd": [
      "docker",
      "version"
    ],
    "name": "docker version"
  },
  {
    "cmd": [
      "luci-auth",
      "token",
      "-scopes",
      "https://www.googleapis.com/auth/cloud-platform",
      "-lifetime",
      "3m"
    ],
    "infra_step": true,
    "name": "get access token for default account",
    "stdout": "/path/to/tmp/"
  },
  {
    "cmd": [
      "python",
      "-u",
      "RECIPE_MODULE[build::docker]/resources/docker_login.py",
      "--server",
      "gcr.io",
      "--service-account-token-file",
      "extra.secret.token.should.not.be.logged",
      "--config-file",
      "[CLEANUP]/.docker"
    ],
    "name": "docker login"
  },
  {
    "cmd": [
      "python",
      "-u",
      "RECIPE_MODULE[build::docker]/resources/docker_run.py",
      "--config-file",
      "[CLEANUP]/.docker",
      "--image",
      "gcr.io/chromium-container-registry/testimage",
      "--dir-map",
      "/foo",
      "/bar",
      "--",
      "test",
      "cmd"
    ],
    "name": "docker run"
  },
  {
    "cmd": [
      "docker",
      "--config",
      "[CLEANUP]/.docker",
      "push",
      "gcr.io/chromium-container-registry/image:2018-11-16-01-25"
    ],
    "name": "docker push"
  },
  {
    "jsonResult": null,
    "name": "$result"
  }
]