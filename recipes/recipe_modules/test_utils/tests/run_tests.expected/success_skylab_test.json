[
  {
    "cmd": [],
    "name": "test_pre_run"
  },
  {
    "cmd": [],
    "name": "test_pre_run.schedule tests on skylab",
    "~followup_annotations": [
      "@@@STEP_NEST_LEVEL@1@@@",
      "@@@STEP_LINK@suite link@https://cr-buildbucket.appspot.com/build/1234@@@"
    ]
  },
  {
    "cmd": [
      "bb",
      "batch",
      "-host",
      "cr-buildbucket.appspot.com"
    ],
    "infra_step": true,
    "name": "test_pre_run.schedule tests on skylab.buildbucket.schedule",
    "stdin": "{\"requests\": [{\"scheduleBuild\": {\"builder\": {\"bucket\": \"testplatform\", \"builder\": \"cros_test_platform\", \"project\": \"chromeos\"}, \"experimental\": \"NO\", \"fields\": \"builder,createTime,createdBy,critical,endTime,id,input,number,output,startTime,status,updateTime\", \"priority\": 30, \"properties\": {\"requests\": {\"basic_EVE_TOT\": {\"params\": {\"decorations\": {\"tags\": [\"label-board:eve\", \"lacros_gcs_path:gs://dummy/lacros.zip\", \"build:gs://chromeos-image-archive/eve-release/R89-13631.0.0\", \"suite:tast.lacros\", \"exe_rel_path:out/Lacros/chrome\", \"tast-expr:lacros.Basic\", \"label-pool:DUT_POOL_QUOTA\"]}, \"metadata\": {\"debugSymbolsArchiveUrl\": \"gs://chromeos-image-archive/eve-release/R89-13631.0.0\", \"testMetadataUrl\": \"gs://chromeos-image-archive/eve-release/R89-13631.0.0\"}, \"retry\": {\"allow\": true, \"max\": 3.0}, \"scheduling\": {\"managedPool\": \"MANAGED_POOL_QUOTA\", \"qsAccount\": \"lacros\"}, \"softwareAttributes\": {\"buildTarget\": {\"name\": \"eve\"}}, \"softwareDependencies\": [{\"chromeosBuild\": \"eve-release/R89-13631.0.0\"}, {\"lacrosGcsPath\": \"gs://dummy/lacros.zip\"}], \"time\": {\"maximumDuration\": \"3600s\"}}, \"testPlan\": {\"test\": [{\"autotest\": {\"name\": \"tast.lacros\", \"testArgs\": \"dummy=crbug.com/984103 tast_expr_b64=bGFjcm9zLkJhc2lj exe_rel_path=out/Lacros/chrome\"}}]}}}}, \"requestId\": \"8945511751514863184-00000000-0000-0000-0000-000000001337\", \"tags\": [{\"key\": \"parent_buildbucket_id\", \"value\": \"8945511751514863184\"}, {\"key\": \"user_agent\", \"value\": \"recipe\"}]}}]}",
    "~followup_annotations": [
      "@@@STEP_NEST_LEVEL@2@@@",
      "@@@STEP_LOG_LINE@json.output@{@@@",
      "@@@STEP_LOG_LINE@json.output@  \"responses\": [@@@",
      "@@@STEP_LOG_LINE@json.output@    {@@@",
      "@@@STEP_LOG_LINE@json.output@      \"scheduleBuild\": {@@@",
      "@@@STEP_LOG_LINE@json.output@        \"id\": \"1234\"@@@",
      "@@@STEP_LOG_LINE@json.output@      }@@@",
      "@@@STEP_LOG_LINE@json.output@    }@@@",
      "@@@STEP_LOG_LINE@json.output@  ]@@@",
      "@@@STEP_LOG_LINE@json.output@}@@@",
      "@@@STEP_LOG_END@json.output@@@",
      "@@@STEP_LOG_LINE@request@{@@@",
      "@@@STEP_LOG_LINE@request@  \"requests\": [@@@",
      "@@@STEP_LOG_LINE@request@    {@@@",
      "@@@STEP_LOG_LINE@request@      \"scheduleBuild\": {@@@",
      "@@@STEP_LOG_LINE@request@        \"builder\": {@@@",
      "@@@STEP_LOG_LINE@request@          \"bucket\": \"testplatform\", @@@",
      "@@@STEP_LOG_LINE@request@          \"builder\": \"cros_test_platform\", @@@",
      "@@@STEP_LOG_LINE@request@          \"project\": \"chromeos\"@@@",
      "@@@STEP_LOG_LINE@request@        }, @@@",
      "@@@STEP_LOG_LINE@request@        \"experimental\": \"NO\", @@@",
      "@@@STEP_LOG_LINE@request@        \"fields\": \"builder,createTime,createdBy,critical,endTime,id,input,number,output,startTime,status,updateTime\", @@@",
      "@@@STEP_LOG_LINE@request@        \"priority\": 30, @@@",
      "@@@STEP_LOG_LINE@request@        \"properties\": {@@@",
      "@@@STEP_LOG_LINE@request@          \"requests\": {@@@",
      "@@@STEP_LOG_LINE@request@            \"basic_EVE_TOT\": {@@@",
      "@@@STEP_LOG_LINE@request@              \"params\": {@@@",
      "@@@STEP_LOG_LINE@request@                \"decorations\": {@@@",
      "@@@STEP_LOG_LINE@request@                  \"tags\": [@@@",
      "@@@STEP_LOG_LINE@request@                    \"label-board:eve\", @@@",
      "@@@STEP_LOG_LINE@request@                    \"lacros_gcs_path:gs://dummy/lacros.zip\", @@@",
      "@@@STEP_LOG_LINE@request@                    \"build:gs://chromeos-image-archive/eve-release/R89-13631.0.0\", @@@",
      "@@@STEP_LOG_LINE@request@                    \"suite:tast.lacros\", @@@",
      "@@@STEP_LOG_LINE@request@                    \"exe_rel_path:out/Lacros/chrome\", @@@",
      "@@@STEP_LOG_LINE@request@                    \"tast-expr:lacros.Basic\", @@@",
      "@@@STEP_LOG_LINE@request@                    \"label-pool:DUT_POOL_QUOTA\"@@@",
      "@@@STEP_LOG_LINE@request@                  ]@@@",
      "@@@STEP_LOG_LINE@request@                }, @@@",
      "@@@STEP_LOG_LINE@request@                \"metadata\": {@@@",
      "@@@STEP_LOG_LINE@request@                  \"debugSymbolsArchiveUrl\": \"gs://chromeos-image-archive/eve-release/R89-13631.0.0\", @@@",
      "@@@STEP_LOG_LINE@request@                  \"testMetadataUrl\": \"gs://chromeos-image-archive/eve-release/R89-13631.0.0\"@@@",
      "@@@STEP_LOG_LINE@request@                }, @@@",
      "@@@STEP_LOG_LINE@request@                \"retry\": {@@@",
      "@@@STEP_LOG_LINE@request@                  \"allow\": true, @@@",
      "@@@STEP_LOG_LINE@request@                  \"max\": 3.0@@@",
      "@@@STEP_LOG_LINE@request@                }, @@@",
      "@@@STEP_LOG_LINE@request@                \"scheduling\": {@@@",
      "@@@STEP_LOG_LINE@request@                  \"managedPool\": \"MANAGED_POOL_QUOTA\", @@@",
      "@@@STEP_LOG_LINE@request@                  \"qsAccount\": \"lacros\"@@@",
      "@@@STEP_LOG_LINE@request@                }, @@@",
      "@@@STEP_LOG_LINE@request@                \"softwareAttributes\": {@@@",
      "@@@STEP_LOG_LINE@request@                  \"buildTarget\": {@@@",
      "@@@STEP_LOG_LINE@request@                    \"name\": \"eve\"@@@",
      "@@@STEP_LOG_LINE@request@                  }@@@",
      "@@@STEP_LOG_LINE@request@                }, @@@",
      "@@@STEP_LOG_LINE@request@                \"softwareDependencies\": [@@@",
      "@@@STEP_LOG_LINE@request@                  {@@@",
      "@@@STEP_LOG_LINE@request@                    \"chromeosBuild\": \"eve-release/R89-13631.0.0\"@@@",
      "@@@STEP_LOG_LINE@request@                  }, @@@",
      "@@@STEP_LOG_LINE@request@                  {@@@",
      "@@@STEP_LOG_LINE@request@                    \"lacrosGcsPath\": \"gs://dummy/lacros.zip\"@@@",
      "@@@STEP_LOG_LINE@request@                  }@@@",
      "@@@STEP_LOG_LINE@request@                ], @@@",
      "@@@STEP_LOG_LINE@request@                \"time\": {@@@",
      "@@@STEP_LOG_LINE@request@                  \"maximumDuration\": \"3600s\"@@@",
      "@@@STEP_LOG_LINE@request@                }@@@",
      "@@@STEP_LOG_LINE@request@              }, @@@",
      "@@@STEP_LOG_LINE@request@              \"testPlan\": {@@@",
      "@@@STEP_LOG_LINE@request@                \"test\": [@@@",
      "@@@STEP_LOG_LINE@request@                  {@@@",
      "@@@STEP_LOG_LINE@request@                    \"autotest\": {@@@",
      "@@@STEP_LOG_LINE@request@                      \"name\": \"tast.lacros\", @@@",
      "@@@STEP_LOG_LINE@request@                      \"testArgs\": \"dummy=crbug.com/984103 tast_expr_b64=bGFjcm9zLkJhc2lj exe_rel_path=out/Lacros/chrome\"@@@",
      "@@@STEP_LOG_LINE@request@                    }@@@",
      "@@@STEP_LOG_LINE@request@                  }@@@",
      "@@@STEP_LOG_LINE@request@                ]@@@",
      "@@@STEP_LOG_LINE@request@              }@@@",
      "@@@STEP_LOG_LINE@request@            }@@@",
      "@@@STEP_LOG_LINE@request@          }@@@",
      "@@@STEP_LOG_LINE@request@        }, @@@",
      "@@@STEP_LOG_LINE@request@        \"requestId\": \"8945511751514863184-00000000-0000-0000-0000-000000001337\", @@@",
      "@@@STEP_LOG_LINE@request@        \"tags\": [@@@",
      "@@@STEP_LOG_LINE@request@          {@@@",
      "@@@STEP_LOG_LINE@request@            \"key\": \"parent_buildbucket_id\", @@@",
      "@@@STEP_LOG_LINE@request@            \"value\": \"8945511751514863184\"@@@",
      "@@@STEP_LOG_LINE@request@          }, @@@",
      "@@@STEP_LOG_LINE@request@          {@@@",
      "@@@STEP_LOG_LINE@request@            \"key\": \"user_agent\", @@@",
      "@@@STEP_LOG_LINE@request@            \"value\": \"recipe\"@@@",
      "@@@STEP_LOG_LINE@request@          }@@@",
      "@@@STEP_LOG_LINE@request@        ]@@@",
      "@@@STEP_LOG_LINE@request@      }@@@",
      "@@@STEP_LOG_LINE@request@    }@@@",
      "@@@STEP_LOG_LINE@request@  ]@@@",
      "@@@STEP_LOG_LINE@request@}@@@",
      "@@@STEP_LOG_END@request@@@",
      "@@@STEP_LINK@1234@https://cr-buildbucket.appspot.com/build/1234@@@"
    ]
  },
  {
    "cmd": [],
    "name": "collect skylab results",
    "~followup_annotations": [
      "@@@STEP_LOG_LINE@return value@basic_EVE_TOT@@@",
      "@@@STEP_LOG_END@return value@@@"
    ]
  },
  {
    "cmd": [],
    "name": "collect skylab results.buildbucket.collect",
    "~followup_annotations": [
      "@@@STEP_NEST_LEVEL@1@@@"
    ]
  },
  {
    "cmd": [
      "bb",
      "collect",
      "-host",
      "cr-buildbucket.appspot.com",
      "-interval",
      "60s",
      "1234"
    ],
    "infra_step": true,
    "name": "collect skylab results.buildbucket.collect.wait",
    "timeout": 3600,
    "~followup_annotations": [
      "@@@STEP_NEST_LEVEL@2@@@"
    ]
  },
  {
    "cmd": [
      "bb",
      "batch",
      "-host",
      "cr-buildbucket.appspot.com"
    ],
    "infra_step": true,
    "name": "collect skylab results.buildbucket.collect.get",
    "stdin": "{\"requests\": [{\"getBuild\": {\"fields\": \"builder,createTime,createdBy,critical,endTime,id,input,number,output,startTime,status,updateTime\", \"id\": \"1234\"}}]}",
    "~followup_annotations": [
      "@@@STEP_NEST_LEVEL@2@@@",
      "@@@STEP_LOG_LINE@json.output@{@@@",
      "@@@STEP_LOG_LINE@json.output@  \"responses\": [@@@",
      "@@@STEP_LOG_LINE@json.output@    {@@@",
      "@@@STEP_LOG_LINE@json.output@      \"getBuild\": {@@@",
      "@@@STEP_LOG_LINE@json.output@        \"id\": \"1234\", @@@",
      "@@@STEP_LOG_LINE@json.output@        \"output\": {@@@",
      "@@@STEP_LOG_LINE@json.output@          \"properties\": {@@@",
      "@@@STEP_LOG_LINE@json.output@            \"compressed_responses\": \"eJxVj71qwzAUhbHJEExbjMeMHQuyZDv+ScZCli5dQulSjKyoikD2NffK5FUKXfsMfb42blPo9p3l\\nfOckn2F03Umyqt097dr94z75CJPFMoiD1XsYvYXJ89H7kbacK5uqI0Jvpz4FNHzkc9RAvJusO2gk\\n7jX5Fqdh0PiPu6YpNnlV5lWdVU1VFqUoV4vlGAe3V04qBErvzyPuXi428tIOThOlCnBMDYBx+pt7\\n3iGcSP/JmZw8nF0MNU3OE6eTxN4Ohq3rTFZFpzZq3WQiE3x7E0UGtR5aJUnHwcMmqs387VI2Fzkw\\nP1fY7/wR4cBzkWdMVEzk/BXgCwDrZnU=\\n\"@@@",
      "@@@STEP_LOG_LINE@json.output@          }@@@",
      "@@@STEP_LOG_LINE@json.output@        }, @@@",
      "@@@STEP_LOG_LINE@json.output@        \"status\": \"SUCCESS\"@@@",
      "@@@STEP_LOG_LINE@json.output@      }@@@",
      "@@@STEP_LOG_LINE@json.output@    }@@@",
      "@@@STEP_LOG_LINE@json.output@  ]@@@",
      "@@@STEP_LOG_LINE@json.output@}@@@",
      "@@@STEP_LOG_END@json.output@@@",
      "@@@STEP_LOG_LINE@request@{@@@",
      "@@@STEP_LOG_LINE@request@  \"requests\": [@@@",
      "@@@STEP_LOG_LINE@request@    {@@@",
      "@@@STEP_LOG_LINE@request@      \"getBuild\": {@@@",
      "@@@STEP_LOG_LINE@request@        \"fields\": \"builder,createTime,createdBy,critical,endTime,id,input,number,output,startTime,status,updateTime\", @@@",
      "@@@STEP_LOG_LINE@request@        \"id\": \"1234\"@@@",
      "@@@STEP_LOG_LINE@request@      }@@@",
      "@@@STEP_LOG_LINE@request@    }@@@",
      "@@@STEP_LOG_LINE@request@  ]@@@",
      "@@@STEP_LOG_LINE@request@}@@@",
      "@@@STEP_LOG_END@request@@@",
      "@@@STEP_LINK@1234@https://cr-buildbucket.appspot.com/build/1234@@@"
    ]
  },
  {
    "cmd": [
      "rdb",
      "query",
      "-json",
      "-n",
      "1000",
      "-tr-fields",
      "testId,variant,variantHash,status,tags,expected",
      "build-8839265267168653505"
    ],
    "infra_step": true,
    "name": "basic_EVE_TOT results",
    "~followup_annotations": [
      "@@@STEP_LOG_END@raw_io.output@@@"
    ]
  },
  {
    "cmd": [],
    "name": "basic_EVE_TOT",
    "~followup_annotations": [
      "@@@STEP_TEXT@<br/>1 passed, 0 failed (1 total)@@@",
      "@@@STEP_LOG_LINE@Test Cases@PASSED:@@@",
      "@@@STEP_LOG_LINE@Test Cases@green_case@@@",
      "@@@STEP_LOG_LINE@Test Cases@@@@",
      "@@@STEP_LOG_END@Test Cases@@@",
      "@@@STEP_LINK@Test Run@https://ci.chromium.org/p/chromeos/builders/test_runner/test_runner/b8839265267168653505@@@",
      "@@@STEP_LINK@Logs(stainless)@https://stainless.corp.google.com/browse/chromeos-autotest-results/swarming-471a63bc9c481010/@@@"
    ]
  },
  {
    "cmd": [
      "rdb",
      "rpc",
      "luci.resultdb.v1.Recorder",
      "UpdateIncludedInvocations",
      "-include-update-token"
    ],
    "infra_step": true,
    "name": "include skylab_test_runner invocations",
    "stdin": "{\"addInvocations\": [\"invocations/build-8839265267168653505\"], \"includingInvocation\": \"invocations/build:8945511751514863184\"}",
    "~followup_annotations": [
      "@@@STEP_LOG_LINE@json.output@{}@@@",
      "@@@STEP_LOG_END@json.output@@@",
      "@@@STEP_LOG_LINE@json.input@{@@@",
      "@@@STEP_LOG_LINE@json.input@  \"addInvocations\": [@@@",
      "@@@STEP_LOG_LINE@json.input@    \"invocations/build-8839265267168653505\"@@@",
      "@@@STEP_LOG_LINE@json.input@  ], @@@",
      "@@@STEP_LOG_LINE@json.input@  \"includingInvocation\": \"invocations/build:8945511751514863184\"@@@",
      "@@@STEP_LOG_LINE@json.input@}@@@",
      "@@@STEP_LOG_END@json.input@@@"
    ]
  },
  {
    "cmd": [],
    "name": "$debug - all results",
    "~followup_annotations": [
      "@@@STEP_LOG_LINE@serialzed results@{@@@",
      "@@@STEP_LOG_LINE@serialzed results@  \"all_suites\": [@@@",
      "@@@STEP_LOG_LINE@serialzed results@    {@@@",
      "@@@STEP_LOG_LINE@serialzed results@      \"invalid\": \"True\", @@@",
      "@@@STEP_LOG_LINE@serialzed results@      \"suite_name\": \"basic_EVE_TOT\", @@@",
      "@@@STEP_LOG_LINE@serialzed results@      \"test_name_to_test_id_mapping\": {}, @@@",
      "@@@STEP_LOG_LINE@serialzed results@      \"total_tests_ran\": 0, @@@",
      "@@@STEP_LOG_LINE@serialzed results@      \"unexpected_failing_tests\": [], @@@",
      "@@@STEP_LOG_LINE@serialzed results@      \"unexpected_passing_tests\": [], @@@",
      "@@@STEP_LOG_LINE@serialzed results@      \"unexpected_skipped_tests\": [], @@@",
      "@@@STEP_LOG_LINE@serialzed results@      \"variant_hash\": \"\"@@@",
      "@@@STEP_LOG_LINE@serialzed results@    }@@@",
      "@@@STEP_LOG_LINE@serialzed results@  ], @@@",
      "@@@STEP_LOG_LINE@serialzed results@  \"unexpected_failing_suites\": [@@@",
      "@@@STEP_LOG_LINE@serialzed results@    \"basic_EVE_TOT\"@@@",
      "@@@STEP_LOG_LINE@serialzed results@  ]@@@",
      "@@@STEP_LOG_LINE@serialzed results@}@@@",
      "@@@STEP_LOG_END@serialzed results@@@"
    ]
  },
  {
    "name": "$result"
  }
]